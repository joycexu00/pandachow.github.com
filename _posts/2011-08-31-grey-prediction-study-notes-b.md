---
layout: post
title: 灰色预测学习笔记(二)
categories:
- research
tags:
- MATLAB
- Artificial Intelligence
- Mathematical Modeling
- Algorithm
---

上次笔记重点是灰色预测的理论部分, 这次来讲讲 MATLAB 的实现过程.

灰色预测中有很多关于矩阵的运算, 当然也是 MATLAB 的专长, 所以用 MATLAB 是做灰色预测的首选. 用 MATLAB 编写灰色预测程序的时候, 可以完全按照预测模型的求解步骤来:
1. 对原始数据进行累加.
2. 构造累加矩阵$$\textbf{B}$$与常数向量.
3. 求解灰参数.
4. 将参数带入预测模型进行数据预测.

下面以某公司收入预测问题为例来介绍灰色预测的matlab实现过程.
已知某公司1999-2008年的利润为[89677, 99215, 109655, 120333, 135823, 159878, 182321, 209407, 246619, 300670], 现在要预测该公司未来几年的利润情况.

    
    %公司收入灰色预测matlab程序
    clear
    syms a b;
    c=[a b]';
    A=[89677, 99215, 109655, 120333, 135823, 159878, 182321, 209407, 246619, 300670];
    B=cumsum(A);%原始数据累加
    n=length(A);
    for i=1:(n-1)
        C(i)=(B(i)+B(i+1))/2;
    end
    % 计算待定参数的值
    D=A;D(1)=[];
    D=D';
    E=[-C;ones(1,n-1)];
    c=inv(E*E')*E*D;
    c=c';
    a=c(1);b=c(2);
    % 预测后续数据
    F=[];F(1)=A(1);
    for i=2:(n+10)
        F(i)=(A(1)-b/a)/exp(a*(i-1))+b/a;
    end
    G=[];G(1)=A(1);
    for i=2:(n+10)
        G(i)=F(i)-F(i-1);
    end
    t1=1999:2008;
    t2=1999:2018;
    G
    plot(t1,A,'*',t2,G)


预测结果:
	G =
	1.0e+06 *
	Columns 1 through 9
	0.0897 0.0893 0.1034 0.1196 0.1385 0.1602 0.1854 0.2146 0.2483
	Columns 10 through 18
	0.2873 0.3325 0.3847 0.4452 0.5152 0.5962 0.6899 0.7984 0.9239
	Columns 19 through 20
	1.0691 1.2371
预测数据和原始数据的比较图:
[![](http://panda0411.com/wordpress/wp-content/uploads/2011/08/gray01.jpg)](http://panda0411.com/wordpress/wp-content/uploads/2011/08/gray01.jpg)

灰色预测的程序说明
1. 先熟悉程序中各条命令的功能, 以加深对灰色预测理论的理解.
2. 在实际使用的时候, 可以直接套用这段程序, 把原数据和时间序列数据替换就可以了.
3. 模型的误差检验可以灵活处理. 当然可以对预测数据进行其他方式的精度检验.

下面继续举例应用, 拿CUMCM 2005 的A题做示例.

题目: 长江水质问题是一个复杂非线性系统, 但是由于数据样本太少, 需要预测的时间太长, 直接用神经网络很难去的理想的效果. 考虑到污水排放量的变化规律是一个不确定的系统, 且这道题给出污水排放量的数据样本实在是太小了, 更蛋疼的是还要做出10年的预测, 于是采用灰色预测来预测未来的污水排放量.
对原题中的数据进行整理可以得到10年的长江污水量排放数据
-------------------------------------------------------------------------------------
年份               |1995|1996|1997|1998|1999|2000|2001|2002|2003|2004|
-------------------------------------------------------------------------------------
污水量/亿吨| 174  | 179  | 183  | 189 | 207  | 234 |220.5| 256 | 270  | 285  |
-------------------------------------------------------------------------------------
以前面的程序为基础, 更新时间轴数据, 即可得到新程序的程序输出:

    
    %长江污水预测matlab程序
    clear
    syms a b;
    c=[a b]';
    A=[174, 179, 183, 189, 207, 234, 220.5, 256, 270, 285];
    B=cumsum(A); %原始数据累加
    n=length(A);
    for i=1:(n-1)
        C(i)=(B(i)+B(i+1))/2; %生成累加矩阵
    end
    % 计算待定参数的值
    D=A;D(1)=[];
    D=D';
    E=[-C;ones(1,n-1)];
    c=inv(E*E')*E*D;
    c=c';
    a=c(1);b=c(2);
    % 预测后续数据
    F=[];F(1)=A(1);
    for i=2:(n+10)
        F(i)=(A(1)-b/a)/exp(a*(i-1))+b/a;
    end
    G=[];G(1)=A(1);
    for i=2:(n+10)
        G(i)=F(i)-F(i-1);
    end
    t1=1995:2004;
    t2=1995:2014;
    G;a,b %输出预测值, 发展系数和灰色作用量
    plot(t1,A,'r*',t2,G)%原始数据与预测数据的比较


输出结果:
	a =
	-0.0624
	b =
	156.6162
[![](http://panda0411.com/wordpress/wp-content/uploads/2011/08/gray02.jpg)](http://panda0411.com/wordpress/wp-content/uploads/2011/08/gray02.jpg)
