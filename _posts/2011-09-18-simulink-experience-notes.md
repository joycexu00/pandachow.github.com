---
layout: post
title: Simulink心得札记
categories:
- technology
tags:
- MATLAB
- Simulink
- Mathematical Modeling
---

一般来说，有许多因素可以影响仿真的性能和精度，这些因素包括模型的设计、构造、仿真参数的设定等等。大部分的情况来看，使用默认的参数Simulink求解器就已经可以有效地处理大部分系统模型的仿真问题了。但是对于一些模型，适当地调节参数会得到更好的效果，当然，这些参数的调整都是以你已经了解参数的意义和模型的特点和行为为前提的。


## 加快仿真速度

仿真速度的缓慢可以由很难多原因导致，比如：
	
  * 模型中含有MATLAB函数模块。如果一个模型中含有一个MATLAB函数模块，那么在每个时步点上，Simulink的引擎都要去调用MATLAB解译器，从而也就大大降低了放着的速度，因此我们要尽量采用内建函数模块。
  * 模型中大量使用了MATLAB文件S-function。同样，这样也会造成在每一时步上对MATLAB解译器的调用。对于这话中情况可以考虑将含有MATLAB文件S-function的部分转换成为子系统或者采用C-MEX文件S-function。
  * 模型有记忆模块。采用记忆模块会让阶数可变的求解器（Ode15s和Ode113）在每个时步点将阶数重新设置到1.
  * 最大的步长太小了。有的时候我们会为了一些不会太明显的效果去修改步长，我推荐先用缺省的步长试一下。
  * 精度的要求太高了。相对容差的缺省值（0.1%的精度）通常是足够了。对于有些模型，它们的一些状态变量的取值是可以到0.如果绝对容差太小了的话，仿真就会在零状态附近取太多的时步。
  * 对于一个僵硬的问题，仅仅从设计上的角度选择解决僵硬系统的求解器；为求改善可以试着采用Ode15s。
  * 多采样率模型的各采样率之间不成倍数。在这种情况下，求解器就会取很小的时步以保证各采样率下的采样点都会成会时步点。
  * 模型中有代数环。代数环的解是在每个时步点通过迭代的方法得到的，因此会更严重地恶化仿真性能。
  * 模型中的一个积分器的输入是一个随机数模块。对于一个连续时间系统，建议采用带限白噪声模块。

## 改善仿真精度
一种有效的检查仿真精度的办法是：首先采用缺省相对容差值($$10^{-3}$$），在一个合理的时间区间运行系统模型，然后，或者吧相对容差改成$$10^{-4}$$，或者减少绝对容差，再运行系统模型。如果两次仿真的结果的差别没有特别大的变化，那么我们可以认为仿真的解已经收敛。

如果仿真没有观察到模型起始运行的一些行为特征，我们可以减少起始步长，使得仿真不至于跳过系统起始运行时的一些重要行为特征。

### 如果仿真结果在一段时间变得不稳定，那么可能的原因有：

  * 设计的系统的本身不稳定
  * 如果使用的求解器是Ode15s，可能要将其最高阶数进行一些限制，如限制为2，或者试着采用Ode23s。

### 如果仿真结果看起来不那么准确，那么：
	
  * 对于有些模型，其部分状态变量的取值可能接近或者为零。这种情况下，如果绝对容差太大就会导致仿真在系统状态的零值附近所取的时步点过小。可以减少绝对容差或者对个别状态的容差进行调整。
  * 如果减少绝对容差没有能显著改善仿真精度，可以尝试减少一下相对容差，减少可接受误差，同时可以适当减小一下步长，增加仿真的时步点。

## 参考资料：
《Simulink与信号处理》--丁亦农





